(()=>{"use strict";console.log("Welcome to Prompt Beauty"),window.addEventListener("DOMContentLoaded",(e=>{"/post-image/"===top.location.pathname.toString()&&(console.log("Post Image page detected"),async function(){const e=document.querySelector("#bb_image"),t=document.querySelector("#bb_preview_image"),o=document.querySelector("#bb_title"),n=document.querySelector("#bb_title_is_prompt"),i=document.querySelector("#bb_model"),c=document.querySelector("#bb_description"),s=document.querySelector("#bb_submit");e.addEventListener("change",(e=>{const o=e.target.files[0];if(!o)return t.src="",void(t.style.display="none");t.src=URL.createObjectURL(o),t.style.display="block"})),s.addEventListener("click",(async function(){const t=new FormData;t.append("file",e.files[0]),t.append("status","publish"),t.append("title",o.value);const s=wp_api_settings.root+"wp/v2/media",a={method:"POST",headers:{"Content-Disposition":"attachment","X-WP-Nonce":wp_api_settings.nonce},body:t},l=await fetch(s,a),{id:r}=await l.json();!async function(e){console.log("imageId",e),console.log("typeof imageId",typeof e);const t=wp_api_settings.root+"wp/v2/images/",s={title:o.value,featured_media:e,acf:{title_is_prompt:n.checked,model:i.value,description:c.value},status:"publish"},a={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":wp_api_settings.nonce},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(s)},l=await fetch(t,a),r=await l.json();console.log("data.link:"),console.log(r.link),console.log(typeof r.link),r.link?console.log("success",r):console.log("Error",r)}(r)}))}())}))})();