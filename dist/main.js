(()=>{"use strict";console.log("Welcome to Prompt Beauty"),window.addEventListener("DOMContentLoaded",(e=>{"/post-image/"===top.location.pathname.toString()&&(console.log("Post Image page detected"),async function(){const e=document.querySelector("#bb_image"),t=document.querySelector("#bb_preview_image"),o=document.querySelector("#bb_title"),n=document.querySelector("#bb_title_is_prompt"),i=document.querySelector("#bb_model"),a=document.querySelector("#bb_description"),c=document.querySelector("#bb_submit");async function s(e){console.log("imageId",e),console.log("typeof imageId",typeof e);const t=wp_api_settings.root+"wp/v2/images/";formData={title:o.value,featured_media:e,acf:{title_is_prompt:n.checked,model:i.value,description:a.value},status:"publish"};const c={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":wp_api_settings.nonce},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(formData)},s=await fetch(t,c),r=await s.json(),l=r.link;l||console.log("Error",r),window.location.href=l}e.addEventListener("change",(e=>{const o=e.target.files[0];if(!o)return t.src="",void(t.style.display="none");t.src=URL.createObjectURL(o),t.style.display="block"})),c.addEventListener("click",(async function(){const t=new FormData;t.append("file",e.files[0]),t.append("status","publish"),t.append("title",o.value);const n=wp_api_settings.root+"wp/v2/media",i={method:"POST",headers:{"Content-Disposition":"attachment","X-WP-Nonce":wp_api_settings.nonce},body:t},a=await fetch(n,i),{id:c}=await a.json();s(c)}))}())}))})();