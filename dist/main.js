(()=>{"use strict";console.log("Welcome to Prompt Beauty"),window.addEventListener("DOMContentLoaded",(e=>{"/post-image/"===top.location.pathname.toString()&&(console.log("Post Image page detected"),async function(){const e=document.querySelector("#bb_image"),t=document.querySelector("#bb_preview_image"),o=document.querySelector("#bb_title"),n=document.querySelector("#bb_title_is_prompt"),i=document.querySelector("#bb_model"),c=document.querySelector("#bb_description"),a=document.querySelector("#bb_submit");e.addEventListener("change",(e=>{const o=e.target.files[0];if(!o)return t.src="",void(t.style.display="none");t.src=URL.createObjectURL(o),t.style.display="block"})),a.addEventListener("click",(async function(){const t=new FormData;t.append("file",e.files[0]),t.append("status","publish"),t.append("title",o.value);const a=wp_api_settings.root+"wp/v2/media",s={method:"POST",headers:{"Content-Disposition":"attachment","X-WP-Nonce":wp_api_settings.nonce},body:t},r=await fetch(a,s),{id:l}=await r.json();!async function(e){console.log("imageId",e),console.log("typeof imageId",typeof e);const t=wp_api_settings.root+"wp/v2/images/",a={title:o.value,featured_media:e,acf:{title_is_prompt:n.checked,model:i.value,description:c.value},status:"publish"},s={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":wp_api_settings.nonce},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(a)},r=await fetch(t,s),l=await r.json();l.link?window.location.href=l.link:console.log("Error",l)}(l)}))}())}))})();